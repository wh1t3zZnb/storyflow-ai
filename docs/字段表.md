# 字段表（基于当前代码）

本文列出与大模型交互需要的全部数据字段，包含模型结构、字段含义、类型、来源位置。字段覆盖剧本、项目设置、角色、分镜、API 设置与应用状态。

## 1. 角色 Character
- id: string — 唯一标识（src/App.jsx:737）
- name: string — 角色名称（src/App.jsx:697）
- desc: string — 设定摘要/外观性格（src/App.jsx:703）
- age: string — 年龄（src/App.jsx:698）
- gender: string — 性别：男/女/其他（src/App.jsx:699）
- traits: string — 人物特征（逗号分隔）（src/App.jsx:700, src/App.jsx:775）
- backstory: string — 背景故事（src/App.jsx:701, src/App.jsx:781）
- styleTags: string[] — 风格标签（src/App.jsx:702, src/App.jsx:786）
- imageUrl: string — 角色图片 URL（src/App.jsx:704, src/App.jsx:726）
- referenceImages: string[] — 参考图 URL 列表（src/App.jsx:705, src/App.jsx:726）
- avatarColor: string — 头像底色（src/App.jsx:747）

示例
```json
{
  "id": "auto_173..._0",
  "name": "杀手",
  "desc": "写实风格角色，源自剧本提取",
  "age": "30",
  "gender": "男",
  "traits": "冷酷,敏捷",
  "backstory": "雇佣杀手，雨夜行动。",
  "styleTags": ["写实", "黑色电影"],
  "imageUrl": "https://.../killer.png",
  "referenceImages": ["https://.../ref1.png"],
  "avatarColor": "#3b82f6"
}
```

## 2. 分镜 StoryboardFrame
- id: string — 唯一标识（src/App.jsx:46, src/App.jsx:507）
- scene: string — 场号（src/components/StoryboardPane.jsx:31）
- shot: string — 景别（远景/中景/特写等）（src/App.jsx:48）
- character: string — 镜头角色（逗号分隔，首个为主角色）（src/components/StoryboardPane.jsx:46）
- cameraAngle: string — 机位角度（平视/俯视/过肩等）（src/App.jsx:50）
- cameraMovement: string — 运镜（固定/推/跟拍等）（src/App.jsx:51）
- content: string — 画面描述（src/components/StoryboardPane.jsx:44）
- dialogue: string — 台词/音效（src/components/StoryboardPane.jsx:45）
- duration: number — 时长（秒）（src/components/StoryboardPane.jsx:56）
- imageUrl: string — 预览图 URL（生成或角色图映射）（src/App.jsx:592, src/components/StoryboardPane.jsx:36）
- imagePlaceholder: boolean — 是否占位（src/App.jsx:55）

示例
```json
{
  "id": "173...",
  "scene": "3",
  "shot": "中景",
  "character": "店员, 杀手",
  "cameraAngle": "过肩",
  "cameraMovement": "推",
  "content": "男人推开便利店的门，风铃响起。店员趴在柜台上睡觉。",
  "dialogue": "男人：有一包万宝路吗？",
  "duration": 4,
  "imageUrl": "https://.../role_shopkeeper.png",
  "imagePlaceholder": true
}
```

## 3. 项目设置 ProjectSetup
- ratio: string — 视频比例：`16:9` 或 `9:16`（src/components/ProjectSetupModal.jsx:4, src/components/ProjectSetupModal.jsx:28-43）
- style: string — 整体风格（src/components/ProjectSetupModal.jsx:5, src/components/ProjectSetupModal.jsx:47-53）
- open: boolean — 弹窗开关（src/App.jsx:639-643）

示例
```json
{ "ratio": "16:9", "style": "写实" }
```

## 4. API 设置 ApiConfig（本机调试）
- baseUrl: string — API 基地址（src/components/SettingsModal.jsx:28-30, src/utils/apiConfig.js:3-6）
- modelId: string — 模型标识（src/components/SettingsModal.jsx:31-34, src/utils/apiConfig.js:3-6）
- apiKey: string — 密钥（src/components/SettingsModal.jsx:35-38, src/utils/apiConfig.js:3-6）

示例
```json
{ "baseUrl": "https://openrouter.ai/api/v1/chat/completions", "modelId": "google/gemini-2.5-flash", "apiKey": "sk-..." }
```

## 5. 应用状态 AppState（交互与流程）
- activeTab: 'script'|'characters'|'storyboard' — 当前标签（src/App.jsx:464-466）
- script: string — 剧本文本（src/App.jsx:465-466）
- frames: StoryboardFrame[] — 分镜列表（src/App.jsx:466-467）
- characters: Character[] — 角色列表（src/App.jsx:467-468）
- aiPopupState: { isOpen: boolean, frameId: string|null } — AI弹窗状态（src/App.jsx:468-473, src/components/AIEditPopup.jsx:4-6）
- charModal: { open: boolean, initial: Character|null } — 角色编辑弹窗（src/App.jsx:469-470, src/App.jsx:650-654）
- workflowStep: 'script'|'setup'|'roles'|'frames' — 工作流阶段（src/App.jsx:470-474）
- settingsOpen: boolean — 设置弹窗开关（src/App.jsx:471-474）
- apiConfig: ApiConfig — 当前本地 API 配置（src/App.jsx:472-474）
- projectSetup: { open: boolean, ratio: string|null, style: string|null } — 项目设置（src/App.jsx:473-474）
- bannerInfo: { active: boolean, count: number, ratio: string|null, style: string|null } — 角色生成提示条（src/App.jsx:474-475, src/components/CharacterPane.jsx:7-13）
- StoryboardPane.viewMode: 'list'|'board' — 分镜视图模式（src/components/StoryboardPane.jsx:6-14）
- ScriptPane.canSplit: boolean — 拆分按钮可用状态（src/components/ScriptPane.jsx:11-13）

## 6. 与模型交互的输入/输出建议
- 输入
  - script.text — 源剧本（src/App.jsx:465）
  - project.ratio — 视频比例（src/components/ProjectSetupModal.jsx:28-43）
  - project.style — 整体风格（src/components/ProjectSetupModal.jsx:47-53）
  - roles.hints — 由剧本提取的候选角色名（src/App.jsx:539-544）
- 输出
  - roles: Character[] — 生成角色设定（字段参考第1节）
  - frames: StoryboardFrame[] — 正式拆分分镜（字段参考第2节）

## 7. 约束与枚举（建议）
- gender ∈ { 男, 女, 其他 }
- ratio ∈ { 16:9, 9:16 }
- viewMode ∈ { list, board }